(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f0921340","chunk-1737d3f8"],{"14cf":function(t,e,r){"use strict";r("dd67")},"494f":function(t,e,r){},"4cfd":function(t,e,r){"use strict";r("494f")},"603e":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-card",{attrs:{bordered:!1}},[r("div",{staticClass:"table-operator"},[r("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(e){return t.showModal(null)}}},[t._v("新增")])],1),r("div",[r("a-table",{ref:"table",staticClass:"j-table-force-nowrap",attrs:{size:"middle",scroll:{x:!0},bordered:"",rowKey:"id",columns:t.columns,dataSource:t.dataSource,pagination:!1,loading:t.loading},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"status",fn:function(e,a,n){return r("span",{},[0==e?r("a-tag",{attrs:{color:"pink"}},[t._v("禁用")]):t._e(),1==e?r("a-tag",{attrs:{color:"#87d068"}},[t._v("正常")]):t._e()],1)}},{key:"action",fn:function(e,a){return r("span",{},[r("a",{on:{click:function(e){return t.showModal(a)}}},[t._v("编辑")]),r("a-divider",{attrs:{type:"vertical"}}),r("a-dropdown",[r("a",{staticClass:"ant-dropdown-link"},[t._v("更多 "),r("a-icon",{attrs:{type:"down"}})],1),r("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[r("a-menu-item",[r("a-popconfirm",{attrs:{title:"确定删除吗?"},on:{confirm:function(){return t.handleDelete(a.id)}}},[r("a",[t._v("删除")])])],1)],1)],1)],1)}}])})],1),r("gate-way-route-modal",{ref:"modalForm",on:{ok:t.modalFormOk}})],1)},n=[],i=(r("6eb7"),r("ac0d")),o=r("b65a"),s=r("ece6"),l={name:"TenantList",mixins:[o["a"],i["b"]],components:{GateWayRouteModal:s["default"]},data:function(){return{description:"adad管理页面",columns:[{title:"路由ID",align:"center",dataIndex:"routerId"},{title:"路由名称",align:"center",dataIndex:"name"},{title:"路由URI",align:"center",dataIndex:"uri"},{title:"状态",align:"center",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"操作",dataIndex:"action",align:"center",fixed:"right",width:147,scopedSlots:{customRender:"action"}}],url:{list:"/sys/gatewayRoute/list",delete:"/sys/gatewayRoute/delete"},dictOptions:{}}},created:function(){},methods:{showModal:function(t){this.$refs["modalForm"].show(t)}}},u=l,c=(r("14cf"),r("5d22")),d=Object(c["a"])(u,a,n,!1,null,"28fc92be",null);e["default"]=d.exports},"6eb7":function(t,e,r){},dd67:function(t,e,r){},ece6:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.visible?r("a-drawer",{staticStyle:{overflow:"auto","padding-bottom":"53px"},attrs:{title:t.title,maskClosable:!0,width:"45%",placement:"right",closable:!0,visible:t.visible},on:{close:t.handleCancel}},[r("a-form-model",{ref:"form",attrs:{layout:t.layout,"label-col":t.labelCol,"wrapper-col":t.wrapperCol,model:t.router}},[r("a-form-model-item",{attrs:{label:"路由ID"}},[r("a-input",{attrs:{placeholder:"路由唯一ID"},model:{value:t.router.routerId,callback:function(e){t.$set(t.router,"routerId",e)},expression:"router.routerId"}})],1),r("a-form-model-item",{attrs:{label:"路由名称"}},[r("a-input",{attrs:{placeholder:"路由名称"},model:{value:t.router.name,callback:function(e){t.$set(t.router,"name",e)},expression:"router.name"}})],1),r("a-form-model-item",{attrs:{label:"路由URI"}},[r("a-input",{attrs:{placeholder:"路由URL"},model:{value:t.router.uri,callback:function(e){t.$set(t.router,"uri",e)},expression:"router.uri"}})],1),r("a-form-model-item",{attrs:{label:"路由状态",prop:"status"}},[r("a-switch",{attrs:{"default-checked":""},model:{value:t.router.status,callback:function(e){t.$set(t.router,"status",e)},expression:"router.status"}})],1),r("a-form-model-item",{attrs:{prop:"predicates",label:"路由条件"}},[t._l(t.router.predicates,(function(e,a){return r("div",[r("a-divider",[t._v(t._s(e.name)+"\n          "),r("a-icon",{attrs:{type:"delete",size:"22"},on:{click:function(e){return t.removePredicate(t.router,a)}}})],1),r("div",[t._l(e.args,(function(a,n){return[n==t.currentTagIndex?r("a-input",{ref:"input",refInFor:!0,style:{width:"190px"},attrs:{type:"text",size:"small",value:a},on:{change:t.handleInputChange,blur:function(r){return t.handleInputEditConfirm(e,a,n)},keyup:function(r){return!r.type.indexOf("key")&&t._k(r.keyCode,"enter",13,r.key,"Enter")?null:t.handleInputEditConfirm(e,a,n)}}}):r("a-tag",{key:a,attrs:{closable:!0},on:{close:function(){return t.removeTag(e,a)},click:function(e){return t.editTag(a,n)}}},[t._v("\n              "+t._s(a)+"\n            ")])]})),t.inputVisible&&a==t.currentNameIndex?r("a-input",{ref:"input",refInFor:!0,style:{width:"100px"},attrs:{type:"text",size:"small",value:t.inputValue},on:{change:t.handleInputChange,blur:function(r){return t.handleInputConfirm(e)},keyup:function(r){return!r.type.indexOf("key")&&t._k(r.keyCode,"enter",13,r.key,"Enter")?null:t.handleInputConfirm(e)}}}):r("a-tag",{staticStyle:{background:"#fff",borderStyle:"dashed"},on:{click:function(r){return t.showInput(e,a)}}},[r("a-icon",{attrs:{type:"plus"}}),t._v("\n            新建"+t._s(e.name)+"\n          ")],1)],2)],1)})),r("p",{staticClass:"btn",staticStyle:{"padding-top":"10px"}},[r("a-dropdown",[r("a-menu",{attrs:{slot:"overlay"},on:{click:t.predicatesHandleMenuClick},slot:"overlay"},t._l(t.tagArray,(function(e){return r("a-menu-item",{key:e},[t._v(t._s(e))])})),1),r("a-button",{staticStyle:{"margin-left":"8px",width:"100%"},attrs:{type:"dashed"}},[t._v(" 添加路由条件\n            "),r("a-icon",{attrs:{type:"down"}})],1)],1)],1)],2),r("a-form-model-item",{attrs:{prop:"predicates",label:"过滤器"}},[t._l(t.router.filters,(function(e,a){return r("div",[r("a-divider",[t._v(t._s(e.name)+"\n          "),r("a-icon",{attrs:{type:"delete",size:"22"},on:{click:function(e){return t.removeFilter(t.router,a)}}})],1),t._l(e.args,(function(a,n){return r("div",{key:a.key},[r("a-input",{staticStyle:{width:"45%","margin-right":"8px"},attrs:{placeholder:"参数键"},model:{value:a.key,callback:function(e){t.$set(a,"key",e)},expression:"tag.key"}}),r("a-input",{staticStyle:{width:"40%","margin-right":"8px"},attrs:{placeholder:"参数值"},model:{value:a.value,callback:function(e){t.$set(a,"value",e)},expression:"tag.value"}}),r("a-icon",{staticClass:"dynamic-delete-button",attrs:{type:"minus-circle-o"},on:{click:function(r){return t.removeFilterParams(e,n)}}})],1)})),r("a-button",{staticStyle:{"margin-left":"28%",width:"30%"},attrs:{type:"dashed",size:"small"},on:{click:function(r){return t.addFilterParams(e)}}},[r("a-icon",{attrs:{type:"plus"}}),t._v("\n          添加参数\n        ")],1)],2)})),r("p",{staticClass:"btn",staticStyle:{"padding-top":"10px"}},[r("a-dropdown",[r("a-menu",{attrs:{slot:"overlay"},on:{click:t.filterHandleMenuClick},slot:"overlay"},t._l(t.filterArray,(function(e){return r("a-menu-item",{key:e.key,attrs:{name:e.name}},[t._v(t._s(e.name))])})),1),r("a-button",{staticStyle:{"margin-left":"8px",width:"100%"},attrs:{type:"dashed"}},[t._v(" 添加过滤器\n            "),r("a-icon",{attrs:{type:"down"}})],1)],1)],1)],2),r("a-row",{staticClass:"drawer-bootom-button",style:{textAlign:"right"}},[r("a-button",{style:{marginRight:"8px"},on:{click:t.handleCancel}},[t._v("\n        关闭\n      ")]),r("a-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确定")])],1)],1)],1):t._e()},n=[],i=r("0fea");function o(t,e){if(null==t)return{};var r,a,n=s(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)r=i[a],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function s(t,e){if(null==t)return{};var r,a,n={},i=Object.keys(t);for(a=0;a<i.length;a++)r=i[a],e.indexOf(r)>=0||(n[r]=t[r]);return n}function l(t){return f(t)||d(t)||c(t)||u()}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t,e){if(t){if("string"===typeof t)return p(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(t,e):void 0}}function d(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function f(t){if(Array.isArray(t))return p(t)}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=new Array(e);r<e;r++)a[r]=t[r];return a}var m={name:"GateWayRouteModal",components:{},data:function(){return{layout:"horizontal",labelCol:{span:3},wrapperCol:{span:14},currentNameIndex:0,currentTagIndex:-1,predicates:{},filterArray:[{key:0,name:"熔断器"},{key:1,name:"限流过滤器"}],tagArray:["Path","Host","Cookie","Header","Method","Query","After","Before","Between","RemoteAddr"],inputVisible:!1,inputValue:"",url:{update:"/sys/gatewayRoute/updateAll",clear:"/sys/gatewayRoute/clearRedis"},router:this.getRouter(),title:"路由编辑",visible:!1,loading:!1}},methods:{getRouter:function(){return{routerId:"",name:"",uri:"",predicates:[],filters:[]}},show:function(t){t?(t.status=Boolean(t.status),this.router=t):(this.router=this.getRouter(),this.inputValue=""),this.visible=!0,this.currentTagIndex=-1,this.currentNameIndex=-1},close:function(){this.reset(),this.$emit("close"),this.$refs["form"].resetFields(),this.visible=!1},removeTag:function(t,e){var r=t.args.filter((function(t){return t!==e}));t.args=r},predicatesHandleMenuClick:function(t){this.router.predicates.push({args:[],name:t.key})},editTag:function(t,e){this.currentTagIndex=e},showInput:function(t,e){this.inputVisible=!0,this.currentNameIndex=e},handleInputChange:function(t){this.inputValue=t.target.value},removePredicate:function(t,e){t.predicates.splice(e,1)},removeFilterParams:function(t,e){t.args.splice(e,1)},removeFilter:function(t,e){t.filters.splice(e,1)},addFilterParams:function(t){t.args.push({key:"key"+t.args.length+1,value:""})},filterHandleMenuClick:function(t){0==t.key&&this.router.filters.push({args:[{key:"name",value:"default"},{key:"fallbackUri",value:"forward:/fallback"}],name:"Hystrix",title:this.filterArray[0].name}),1==t.key&&this.router.filters.push({args:[{key:"key-resolver",value:"#{@ipKeyResolver}"},{key:"redis-rate-limiter.replenishRate",value:20},{key:"redis-rate-limiter.burstCapacity",value:20}],name:"RequestRateLimiter",title:this.filterArray[1].name})},handleInputConfirm:function(t){var e=this.inputValue,r=t.args;e&&-1===r.indexOf(e)&&(t.args=[].concat(l(r),[e])),Object.assign(this,{tags:r,inputVisible:!1,inputValue:""}),this.currentTagIndex=-1},handleInputEditConfirm:function(t,e,r){if(this.inputValue){var a=this.inputValue;t.args[r]=a}this.currentTagIndex=-1},reset:function(){this.expandedKeysss=[],this.checkedKeys=[],this.defaultCheckedKeys=[],this.loading=!1},handleCancel:function(){this.close()},handleSubmit:function(){var t=this,e=this.router,r=(e.predicates,e.filters,o(e,["predicates","filters"])),a=r;a.predicates=JSON.stringify(this.router.predicates),a.filters=JSON.stringify(this.router.filters),Object(i["i"])(this.url.update,{router:a}).then((function(e){e.success?(t.close(),t.$emit("ok"),t.$message.success(e.message)):t.$message.error(e.message)}))}}},y=m,h=(r("4cfd"),r("5d22")),g=Object(h["a"])(y,a,n,!1,null,"7df3d545",null);e["default"]=g.exports}}]);